---
title: "leetcode_1596: The Most Frequently Ordered Products for Each Customer
"
date: 2025-06-10
categories: [sql_coding]
tags: []
toc: true
toc_label: "Table of contents"
toc_icon: "cog"
---

## 문제

Table: Customers
| Column Name   | Type    |
|---------------|---------|
| customer_id   | int     |
| name          | varchar |

customer_id is the column with unique values for this table.
This table contains information about the customers.

Table: Orders

| Column Name   | Type    |
|---------------|---------|
| order_id      | int     |
| order_date    | date    |
| customer_id   | int     |
| product_id    | int     |

order_id is the column with unique values for this table.
This table contains information about the orders made by customer_id.
No customer will order the same product more than once in a single day.

Table: Products

| Column Name   | Type    |
|---------------|---------|
| product_id    | int     |
| product_name  | varchar |
| price         | int     |

product_id is the column with unique values for this table.
This table contains information about the products.
 
Write a solution to find the most frequently ordered product(s) for each customer.

The result table should have the product_id and product_name for each customer_id who ordered at least one order.

Return the result table in any order.

The result format is in the following example.

## 내 답안 

~~~sql
SELECT  b.customer_id
        ,b.product_id
        ,a.product_name
  FROM  Products a
  JOIN  (SELECT  customer_id
                ,product_id
                ,COUNT(*) AS num_bought
                ,RANK() OVER (PARTITION BY customer_id ORDER BY COUNT(product_id) DESC) as rk
        FROM  Orders
        GROUP
            BY  1,2)b
    ON  a.product_id = b.product_id
 WHERE  rk = 1;
~~~

